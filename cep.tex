\documentclass{patmorin}
\listfiles
\usepackage{pat}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{paralist}
\usepackage[normalem]{ulem}

\usepackage{todonotes}

% david proposes the following additions
% \renewcommand{\ge}{\geqslant}
% \renewcommand{\le}{\leqslant}
% \renewcommand{\geq}{\geqslant}
% \renewcommand{\leq}{\leqslant}

\newcommand{\vida}[1]{{\color{DarkGreen} Vida: #1}}
\newcommand{\pat}[1]{\textcolor{Blue}{Pat: #1}}
\newcommand{\gwen}[1]{\textcolor{Purple}{Gwen: #1}}
\newcommand{\piotr}[1]{\textcolor{red}{Piotr: #1}}

% \numberwithin{equation}{lem}


\newenvironment{clmproof}{\noindent\emph{Proof of Claim:}}{\hfill\rule{1ex}{1ex}\newline}

\usepackage[longnamesfirst,numbers,sort&compress]{natbib}

% \newcommand{\mathdefin}[1]{\color{brightmaroon}#1}}
\setlength{\parskip}{1ex}

% Document-specific commands and math operators
\DeclareMathOperator{\tw}{tw}
\DeclareMathOperator{\pw}{pw}
\DeclareMathOperator{\bw}{bw}
\DeclareMathOperator{\td}{td}
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\radius}{radius}
\DeclareMathOperator{\pth}{path}
\DeclareMathOperator{\mindist}{min-dist}
\DeclareMathOperator{\mindeg}{min-deg}
\DeclareMathOperator{\girth}{girth}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\ld}{ld}
\DeclareMathOperator{\polylog}{polylog}
\DeclareMathOperator{\evol}{Evol}
\DeclareMathOperator{\ivol}{Ivol}
\DeclareMathOperator{\tvol}{Tvol}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\GG}{\mathcal{G}}

\title{\MakeUppercase{Notes on Coarse {E}rdős–{P}ósa}}

%\title{\MakeUppercase{\boldmath Planar graphs are contained in $\tilde{O}(\sqrt{n})$-blowups of fans}}

%Fan-Partitions of Planar Graphs (and Beyond)  \newline by Local Sparsification and Volume-Preserving Embeddings}}

\author{
 Vida Dujmovi{\'c}\,\footnote{School of Computer Science and Electrical Engineering, University of Ottawa, Ottawa, Canada (\texttt{vida.dujmovic@uottawa.ca}). Research supported by NSERC and a University of Ottawa Research Chair.}
 \qquad
 Gwena\"el Joret\footnote{D\'epartement d'Informatique, Universit\'e libre de Bruxelles, Belgium ({\tt gwenael.joret@ulb.be}). G.\ Joret is supported by the Belgian National Fund for Scientific Research (FNRS) and by the Australian Research Council.}
 \qquad
 Piotr Micek\footnote{Department of Theoretical Computer Science, Jagiellonian University, Kraków, Poland (\texttt{piotr.micek@uj.edu.pl}). Research supported
 the National Science Center of Poland under grant UMO-2018/31/G/ST1/03718 within the BEETHOVEN program.}
 \qquad
 Pat Morin\footnote{School of Computer Science, Carleton University, Ottawa, Canada (\texttt{morin@scs.carleton.ca}). Research supported by NSERC and the Ontario Ministry of Research and Innovation.}}

\date{}


\begin{document}

\maketitle

\section{Introduction}

The \defin{length}, $\ell$, of a path $P:=x_0,\ldots,x_\ell$ is the number of edges in $P$.  For two vertices $x$ and $y$ in a  tree $T$, the \defin{$T$-path}, $\mathdefin{\pth_T(x,y)}$ is the unique path $x_0,\ldots,x_\ell$ in $T$ with $x_0=x$ and $x_\ell=y$. If $Y\subseteq V(T)\setminus\{x\}$ and $T[Y]$ is connected, then $\mathdefin{\pth_T(x,Y)}$ is the shortest path $x_0,\ldots,x_{\ell}$ in $T$ with $x_0=x$ and $x_\ell\in Y$.  For a graph $G$, and two vertices $x$ and $y$ of $G$, $\mathdefin{\dist_G(x,y)}$ is the length of a shortest path, in $G$, with endpoints $x$ and $y$.  For subsets $X$ and $Y$ of $V(G)$, $\mathdefin{\dist_G(X,Y)}:=\min\{\dist_G(x,y):(x,y)\in X\times Y\}$.  For an integer $r\ge 0$ and a vertex $x$ of $G$, $\mathdefin{B_G(x,r)}:=\{y\in V(G):\dist_G(x,y)\le r\}$.  For a subset $S$ of $V(G)$, $\mathdefin{B_G(S,r)}:=\bigcup_{x\in S}B_G(x,r)$, $\mathdefin{\diam_G(S)}:=\max\{\dist_G(x,y):\{x,y\}\in\binom{S}{2}\}$ and $\mathdefin{\radius_G(S)}$ is the minimum integer $r$ such that $S\subseteq B_G(v,r)$ for some $v\in V(G)$.

A set $\mathcal{C}$ of cycles in $G$ is a \defin{$d$-packing} (of cycles in $G$) if $\dist_G(V(C),V(C'))\ge d$ for each distinct $C,C'\in\mathcal{C}$.
The \defin{distance-$d$ $\rho$acking number} of cycles in $G$ is the maximum integer $p$ such that $G$ has a $d$-packing of cycles $\mathcal{C}$ with $|\mathcal{C}|=p$.    For any integer $r\ge 0$, a set $X\subseteq V(G)$ is a \defin{radius-$r$ hitting-set} of cycles in $G$ if $G-B_G(X,r)$ is a forest.  The \defin{radius-$r$ hi$\tau$$\tau$ing number} (of cycles in $G$), $\mathdefin{\tau_r(G)}$, is the minimum integer $t$ such that $G$ has a radius-$r$ hitting set of size $t$.

Note that $\tau_r$ and $\rho_d$ are not monotone graph parameters.  If $G'$ is a subgraph of $G$ then a distance-$d$ packing of cycles in $G'$ may not be a distance-$d$ packing of cycles in $G$ since $\dist_{G}(V(C),V(C'))$ may be less than $\dist_G(V(C),V(C'))$.  Similarly, a radius-$r$ hitting set $X$ for cycles in $G$ may not be a radius-$r$ hitting set for cycles in $G'$, since $B_{G'}(X,r)$ may be a strict subset of $B_{G}(x,r)\cap V(G')$.

\begin{conj}
  There exists functions $f:\N\to\N$ and $g:\N\to\N$ such that, for every graph $G$ and every $d,k\in\N$, $\rho_d(G) \ge k$ or $\tau_{g(d)}(G)\le f(k)$.
\end{conj}


\section{An Exponential Bound}


% \begin{lem}\label{far_away_er}
%   Let $G$ be a graph and let $C$ be a cycle in $G$ of length $\girth(G)$.  Then, for every $k,d\ge 0$ and $r\ge d$, at least one of the following is true:
%   \begin{compactenum}[(a)]
%     \item $G$ contains a cycle $C'$ with $\dist_G(V(C),V(C'))>r-d$;
%     \item $\rho_d(G)> k$; or
%     \item $\tau_{r+2d}(G) \le ck$.
%     \item $\tau_{5r-d}(G) \le 1$.
%   \end{compactenum}
% \end{lem}
%
% \begin{proof}
%   Assume that (a) does not hold. That is, every cycle $C'$ in $G$ has $\dist_G(V(C),V(C'))\le r-d$.  If $\girth(G) \le 4r$, then we can take any vertex $v\in V(C)$ and $B_G(v,5r-d)$ intersects every cycle in $G$, so $\tau_{5r-d}(G)\le 1$, in which case (d) holds.  Now assume $\girth(G) > 4r$.  If $G[B_G(V(C),r)]$ is not unicyclic, then $G[B_G(V(C),r)]$ contains a cycle of length at most
%   \[
%     \girth(G)/2 + 2r < \girth(G) - 2r + 2r = \girth(G) \enspace ,
%   \]
%   which is a contradiction.  Therefore $A:=G[B_G(V(C),r)]$ is unicyclic and $F:=G-B_G(V(C),r-d)$ is a forest.  Now apply the Hungarian result on $(A,F)$ to conclude that at least one of (b) or (c) holds.
% \end{proof}
%
% \begin{cor}\label{k_equals_one}
%   Let $G$ be a graph with $\rho_d(G)\le 1$.  Then $\tau_{3d}(G) \le 2c$ or $\tau_{4d}(G) \le 1$.
% \end{cor}
%
% \begin{proof}
%   If $G$ is a forest, then $\tau_{4d}(G)=0$ and there is nothing to prove. Otherwise, let $C$ be a cycle in $G$ of length $\girth(G)$ and apply \cref{far_away_er} with $r=d$ and $k=1$.  The fact that $\rho_d(G)\le 1$ rules out (a) and (b), leaving only (c) and (d).
% \end{proof}
%
%
%
% \begin{cor}
%   Let $G$ be a graph with $\rho_d(G)\le 2$.  Then $\tau_{?}(G) \le {?}$.
% \end{cor}
%
% \begin{proof}
%   Let $C$ be a cycle in $G$ of length $\girth(G)$.  Apply \cref{far_away_er} with $r={?}d$ and $k=2$. Then alternative (b) is not possible since, by assumption $\rho_d(G)\le 2$.  Alternatives (c) and (d) establish the corollary.  All that remains is to consider alternative (a).  In this case, $G$ contains a cycle $C'$ with $\dist_G(V(C),V(C'))>r$.  By \cref{short_or_unicycle_nearby}, $G$ contains a cycle $C''$ with $\dist_G(V(C),V(C''))\ge ??-d$
%
%
%
%   There are two cases to consider:
% \end{proof}
%
%
%
%
%
%

\piotr{Maybe we could define a ball, e.g.\ $B_G(V(C),t)$ as a subgraph and not as subset of vertices?}

\piotr{Let $|P|$ be the length of the path $P$, i.e.\ the number of edges in $P$.}

\begin{lem}\label{short_or_unicycle_nearby}
  Let $t$ be an integer with $t\ge 0$.
  Let $G$ be a graph and let $C$ be a cycle in $G$.
  Then $B_G(V(C),3t)$ contains a cycle $C'$ such that
  \begin{compactenum}[(a)]
    \item $B_G(V(C'),t)$ is unicyclic; or\label{short_or_unicycle_nearby:unicyclic}
    \item $C'$ has length at most $6t+2$.\label{short_or_unicycle_nearby:short}
  \end{compactenum}
\end{lem}

\begin{proof}
  Let $C_0:=C$.
  We construct inductively a sequence of pairs $(C_i,Q_i)_{i\geq0}$ such that
  (1) $C_i$ is a cycle in $G$;
  (2) $Q_i\subseteq C_i\cap C$, $Q_i$ is connected and contains at least one edge; and
  (3) $C_i$ contains at most $4t+1$ edges not in $Q_i$.
  Note that these two conditions imply that there is a path $P_i\subseteq C_i$  such that
  $P_i$ and $Q_i$ are edge-disjoint and $C_i=P_i\cup Q_i$.
  Thus, $P_i$ is a path of length at most $4t+1$ with both endpoints in $C$
  which implies that all vertices of $P_i$ are in distance at most $2t$ from $C$.
  In particular, $C_i\subseteq B_G(V(C),2t)$.

  Let $i\geq0$ and suppose that we already have defined $C_i$.
  If $B_G(V(C_i),t)$ is unicyclic, then $C_i$ witnesses~\eqref{short_or_unicycle_nearby:unicyclic}.

  Now suppose that $B_G(V(C_i),t)$ contains a cycle $D$ different than $C_i$.
  Let $u$ be a vertex of $D$ that is of maximal distance from $C_i$ among all vertices in $D$.
  Let $P(u)$ be a shortest path from $C$ to $u$.
  Since $u$ is incident to two vertices in $D$ there is a neighbor $v$ of $u$ in $D$ that is not in $P(u)$.
  Let $P(v)$ be a shortest path from $C_i$ to $v$.
  Note that both $P(u)$ and $P(v)$ are of length at most $t$.
  If $P(u)\cup P(v)\cup\{uv\}$ contains a cycle, say $E$, then $E$ has length at most $2t+1$ and $E\subseteq B_G(V(C_i),t)\subseteq B_G(V(C),3t)$, so $E$ witnesses~\eqref{short_or_unicycle_nearby:short}.
  Thus, we assume that $P:=P(u)\cup P(v)\cup\{uv\}$ contains no cycle so it must be a path.
  Also the length of $P$ is at most $2t+1$.

  Now there are three possibilities:
  \begin{compactenum}
    \item Both endpoints of $P$ are in $V(P_{i})$.
    In this case, $P\cup P_{i}$ contains a cycle of length at most
    $(2t+1)+(4t+1)=6t+2$ and this cycle is contained in $B_G(V(C_i),t)\subseteq B_G(V(C),3t)$, so it satisfies~\eqref{short_or_unicycle_nearby:short}.
    \item Both endpoints of $P$ are in $V(Q_{i})\setminus V(P_{i})$.
    In this case, we take $C_{i+1}$ to be a cycle in $Q_{i}\cup P$ and
    we take $Q_{i+1}:= Q_i\cap C_{i+1}$. % and $P_{i+1}:=P\cap C_{i+1}$.
    This works because $P$ has two distinct endpoints in $Q_{i+1}$
    and therefore $Q_{i+1}$ contains at least one edge,
    $Q_{i+1}\subseteq Q_i\subseteq C$, and
    $|P_{i+1}|\leq|P|\leq 2t+1$.
    Furthermore, note that $|Q_{i+1}| < |Q_{i}|$ because $C_{i+1}$ does not contain either endpoint of $Q_{i}$.
    \item Exactly one endpoint of $P$ is in $V(P_{i})$.
    In this case, $C_{i}\cup P$ has two cycles that each contain $P$.
    Each edge of $P_{i}$ belongs to exactly one of these two cycles.
    Therefore one of these cycles uses at most $\lfloor\frac{4t+1}{2}\rfloor=2t$ edges of $P_{i}$.
    We take $C_{i+1}$ to be this cycle and define
    $Q_{i+1}=C_{i+1}\cap Q_i$. %, and $P_{i+1}=C_{i+1}\cap (P\cup P_{i})$.
    Thus, $|P_{i+1}| \leq 2t+|P|\leq 4t+1$.
    Furthermore, note that $|Q_{i+1}| < |Q_{i}|$ because $C_{i+1}$ does not contain one of the endpoints of $Q_{i}$.
  \end{compactenum}
  This process eventually produces the desired cycle $C'$ from the statement since, at each step in the process $|Q_i|$ decreases.
\end{proof}

\begin{lem}\label{grow_unicycle}
  Let $a\ge 2$ be an integer, let $G$ be a graph and let $C$ be a cycle in $G$ such that $G[B_G(V(C),r]$ is unicyclic, for some $r\ge d$.  Then either:
  \begin{compactenum}[(a)]
    \item $G$ has a $d$-packing of $k$ cycles all of whose vertices are contained in $B_G(V(C), ar)$; or
    \item There exists $Y\subseteq B_G(V(C),ar)$ and $X\subseteq B_G(V(C), ar)$ of size $O(k\log k)$ such that $Y\subseteq B_G(X,(2a+1)r+2+d)$ and $(G-Y)[B_G(V(C),ar)]$ is unicyclic.
  \end{compactenum}
\end{lem}

\begin{proof}
  For each $\rho\in\N$, let $G_\rho:=G[B_G(V(C),\rho)]$.  For each $v\in G_{ar}\setminus V(C)$, select a vertex $p_v$ (the \defin{BFS parent} of $v$) such that $\dist_G(p(v),V(C))=\dist_G(v,V(C))-1$.
  Let $U$ (a \defin{BFS unicycle}) be the subgraph of $G_{ar}$ with vertex set $V(U):=V(G_{ar})$ and edge set $E(U):=E(C)\cup\{vp_v:v\in V(U)\setminus V(C)\}$.  Let $v_0$ be an arbitrary vertex of $C$. For any edge $vw\in E(G_{ar})\setminus E(U)$, $U\cup \{vw\}$ has a unique cycle $C_{vw}$ that does not contain $v_0$. Let $P_{vw}$ be the (path or cycle) formed by the edges in $E(C_{vw})\setminus E(C)$ and let $Q_{vw}$ be the (possibly empty) path formed by the edges in $E(C_{cw})\cap E(C)$.  If $C_{vw}$ uses at most $2d+1$ edges of $C$, then we say that $vw$ is of \defin{C-type}, otherwise $vw$ is of \defin{P-type}.  (If $vw$ is of P-type then $P_{vw}$ is indeed a path, but the converse is not necessarily true.)

  Consider the auxilliary graph $H$ that contains a vertex for each $vw\in E(G_{ar})\setminus E(U)$ and contains an edge between $e$ and $e'$ if $\dist_G(V(P_{e}),V(P_{e'})) \le d$.  Let $I$ be a maximal indepedent set in $H$.
  \begin{clm}
    For distinct $e,e'\in I$, $V(Q_e)\cap V(Q_{e'})\neq\emptyset$ or $\dist_G(V(C_e),V(C_{e'})) = \dist_G(V(P_e),V(P_{e'})$.
  \end{clm}

  \begin{proof}
    Since $e$ and $e'$ are both in $I$, $\dist_G(V(P_e),V(P_{e'}))> d>0$.  Therefore $V(P_e)\cap V(P_{e'})=\emptyset$.  Therefore $V(Q_e)\cap V(Q_{e'})=\emptyset$ if and only if $V(C_e)\cap V(C_{e'})=\emptyset$.  Therefore, we can assume that $V(C_e)$....
  \end{proof}



  Suppose first that $|I|\ge 4k\log k+k$.

  \begin{clm}
    If distinct $e,e'\in I$ are both of C-type then $C_e$ and $C_e'$ are disjoint.
  \end{clm}
  \begin{clmproof}
    Otherwise $Q_e$ contains an endpoint $v$ of $P_{e'}$, or vice-versa.  Since $Q_e$ has at most $2d+1$ edges, the distance from $v$ to $P_{e}$ is at most $d$, which is not possible because $I$ is an independent set in $H$.
  \end{clmproof}


  If at least $k$ of the nodes in $I$ are of $C$-type, then the cycles defined by these nodes establish (a) and there is nothing more to do. [\pat{Notice that the definition of C-type is critical here. It prevents two cycles from sharing a segment of $C$, which isn't true for $P$-type nodes.}]  We can therefore assume that $I$ contains at least $2k\log k$ P-type nodes.  Each $P$-type vertex $e$ in $I$ defines a path $P_e$ between two vertices of $C$ that is edge disjoint from $C$.  Consider the graph $S$ obtained by taking the union of $C$ and $P_e$ for every P-type vertex in $I$.  This graph has $2k\log k$ vertices of degree $3$ and all other vertices of degree $2$.  By Simonovitz, this graph has $k$ vertex disjoint cycles $C_1,\ldots,C_k$.  By construction [\pat{Check everything here---the fact that $G[B_G(V(C),r]]$ is unicyclic is critical; it ensures that the parts of cycles formed by segments of $C$ behave like we want.}]  This also establishes (a).

  Therefore, we may assume that $|I|\le 2k\log k+k$.  Since $I$ is a maximal independent set, it is a dominating set in $H$: Every vertex of $H$ is either in $I$ or adjacent to a vertex in $I$.  In $G$ this corresponds to the fact that, for every edge of $vw\in E(G[B_G(V(C),r)])\setminus E(U)$ there exists $xy\in I$ such that $\dist_G(V(P_{vw}),V(P_{xy}))\le d$.  Since $V(P_{xy})\subseteq B_G(x,ar+1)$ and $V(P_{vw})\subseteq B_G(v,ar+1)$, this implies that $B_G(x,(2a+1)r+2+d)$ contains at least one of $v$ or $w$.  We take $X$ to contain one endpoint of each $vw\in I$ and $v_0$.  Since every cycle in $G[B_G(V(C)),ar]$ either contains the vertex $v_0$ or uses some edge $vw\in E(G[B_G(V(C),ar)])\setminus E(U)$, $X$ satisifies (b).
\end{proof}

\begin{lem}\label{double_unicycle}
  Let $G$ be a graph, let $C_a$ and $C_b$ be cycles in $G$ such that $G_a:=G[B_G(V(C_a),r]$ and $G_b:=G[B_G(V(C_b),r]$ are unicyclic, for some $r\ge d$.  Then either:
  \begin{compactenum}[(a)]
    \item $G$ has a $d$-packing of $k$ cycles all of whose vertices are contained in $V(G_a\cup G_b)$; or
    \item There exists $X\subseteq V(G_a\cup G_b)$ of size $O(k\log k)$ such that $V(G_a)\cap V(G_b)\subseteq B_G(X,r)$.
  \end{compactenum}
\end{lem}




REST OF PROOF:

Say that a cycle $C$ in $G$ is \defin{$r$-good} if $G[B_G(V(C),r)]$ is unicyclic.  Take a maximal $d$-packing $C_1,\ldots,C_p$ of $2d$-good cycles.  Then $p< k$. Start with all vertices \defin{unmarked}.  Repeatedly choose a cycle $C$ of length at most $?d$ and \defin{mark} all vertices in $B_G(V(C),d)$.  After less than $k$ iterations, every cycle of length at most $?d$ contains a marked vertex.  Consider some cycle $C$ that contains no marked vertices (so $C$ must have length greater than $?d$.  Then, by \cref{short_or_unicycle_nearby}, $B_G(V(C),6d)$ contains a good cycle $C'$ or a cycle $C''$ of length at most $36d+2\le ?d$.  In the latter case, ignore $C$ and $C''$ (the marked vertices will get them later.  In the former case, $\dist_G(C',C_i)\le d$ for some $i\in\{1,\ldots,p\}$ otherwise $C'$ would be included in our packing.  Therefore $\dist_G(C,C_i)\le 7d$.

Now mark every vertex within distance $??d$ of some vertex marked above.  Now every cycle $C$ in $G$ contains a marked vertex or $\dist_G(C,C_i)\le 7d$ for some $i\in\{1,\ldots,p\}$.  Apply \cref{grow_unicycle} to each $C_i$ with $a=4$ to get a set $Y_i$ so that $(G-Y)[B_G(V(C_i,8d))]$ is unicyclic.  Mark the vertices in $Y_i$ and fix some spanning unicycle $U_i$ of $G[B_G(V(C_i,8d))]$.

Now we will work with the graph $G'$ that removes the edges of each $G[B_G(V(C_i,8d))]$ and replaces them with the edges of $U_1,\ldots,U_p$.  (If $U_i$ and $U_j$ overlap then we do something Voronoi-like.)  Then each $G'[B_G(V(C_i),14d)$ is unicyclic for each $i\in\{1,\ldots,p\}$ and $F':=G'-B_G(V(C_1\cup\cdots\cup C_p),13d)$ is not quite a forest. The graph $F$ obtained by removing marked vertices of $F'$ is a forest.

For each $C_i$ and $C_j$ we do something like \cref{grow_unicycle} to take care of all $C_i$ to $C_j$ paths in $G'[B_G(V(C_i\cup C_j),14d]$.  (In fact, \cref{grow_unicycle} might be a special case of this when $i=j$.)

Next we use Hungarians to take care of any $C_i$ to $C_j$ paths that include vertices in $F$. We don't pass a path $P$ to the Hungarians if $B_G(V(P),d)$ includes a marked vertex.  By now every path that includes a vertex that appears only in $B_G(V(C_i,14d))$ is either close to a marked vertex or is hit by the Hungarian set. DONE!

% \pat{Actually, I think we may be able to avoid Hungarians entirely.  Why not do something like \cref{grow_unicycle} on the graph $G'$?  Throw in all the $C_i$ to $C_j$ and ($C_i$ to $C_i$) paths that are not close to a marked vertex and make an auxilliary graph where two of these paths are adjacent if they are at distance less than $d$ from each other in $G$. Find a maximal independent set $I$ in this graph.  If $I$ defines a subgraph of $G$ with more than $k\log k$ degree-$3$ vertices the we found our $d$-packing of $k$ cycles.  Otherwise, the degree-$3$ vertices can be used to hit all these paths.  Any path that doesn't appear in $I$ is close to some path in $I$ or close to some marked vertex.  In the latter case it will get hit by balls around marked vertices.  In the former case, the only way it can be close to a path in $I$----NAH, this doesn't work.  It might be close because of a path in $F$, and then we won't hit it with balls near the endpoints of paths defined by $I$.}








\piotr{For a moment assume that $d$-packing is cycles in distance $>d$.}

\piotr{my playground version}
\begin{lem}\label{a_or_b2}
  Let $G$ be a graph.
  Let $r$ be an integer with $r\geq0$ and
  let $\mathcal{C}$ be a $2r$-packing of cycles in $G$ such that
  for each $C\in\mathcal{C}$,
  either  $B_G(V(C),r)$ is unicyclic
  or $|V(C)|\le 6r+2$.
  Then, for every $k\ge |\mathcal{C}|$, $d\in\{0,\ldots,r\}$
  the following alternative holds:
  \begin{compactenum}[(a)]
    \item $G$ contains a cycle $C'$ such that
    \begin{compactenum}[(i)]
      \item $\mathcal{C}\cup\{C'\}$ is a $2(r-d)/5$-packing and
      %\item $\dist_G(V(C'),\bigcup_{C\in\mathcal{C}} V(C))\ge 2(r-d)/5$ and
      \item $B_G(V(C'),(r-d)/5)$ is unicyclic or $C'$ has length at most $6(r-d)/5+2$;
    \end{compactenum}
    \item $\rho_d(G)\ge k$; or
    \item $\tau_{r'}(G) \le f(k)+ |\mathcal{C}|$ for $r':=7r+2$.
  \end{compactenum}
\end{lem}

\pat{Suggestion: Replace alternatives (b) and (c) in \cref{a_or_b} with  $G-B_G(V(C_1\cup\cdots\cup C_{p-1}),r-d)$ is a forest.  Then the proof is one paragraph and we can use a separate lemma to explain that this alternative implies one of (b) or (c).}


\begin{lem}\label{a_or_b}
  Let $G$ be a graph and let $C_1,\ldots,C_{p-1}$ be a $2r$-packing of cycles in $G$ such that, for each $i\in\{1,\ldots,p-1\}$,  $G[B_G(V(C_i),r)]$ is unicyclic or $|V(C_i)|\le 6r+2$.  Then, for every $k\ge p$, $d\in\{0,\ldots,r\}$
  %\ge p-1$
  , at least one of the following ((a), (b), or (c)) is true:
  \begin{compactenum}[(a)]
    \item $G$ contains a cycle $C_p$ such that
    \begin{compactenum}[(i)]
      \item $\dist_G(V(C_p),V(C_1\cup\cdots\cup C_{p-1}))\ge 2(r-d)/5$ and
      \item $G[B_G(V(C_p),(r-d)/5)]$ is unicyclic or $|V(C_p)|\le 6(r-d)/5+2$;
    \end{compactenum}
    \item $\rho_d(G)\ge k$; or
    \item $\tau_{r'}(G) \le f(k)+p-1$ for $r':=4r+1$.
  \end{compactenum}
\end{lem}

\begin{proof}
  First, suppose that $G$ contains a cycle $C$ such that $\{C_1,\ldots,C_{p-1},C\}$ is an $(r-d)$-packing of cycles in $G$.  Apply \cref{short_or_unicycle_nearby} with $t:=(r-d)/5$ to find a cycle $C_p$ with $V(C_p)\subseteq B_G(V(C),3t)$ such that $G[B_G(V(C_p),t)]$ is unicyclic or $|V(C_p)|\le 6t+2$.  Thus, $C_p$ satisfies (ii).  For each $i\in\{1,\ldots,p-1\}$, $\dist_G(V(C_p),V(C_i))\ge \dist_G(V(C),V(C_i))-3t > r-d - 3t = 2t$, so $C_p$ satisfies (i). \pat{We actually need $2t+1$ here if we want a $2t$-packing.}

  Now, suppose that $G$ contains no such cycle.  Let $I:=\{i\in\{1,\ldots,p-1\}:|V(C_i)|\le 6r+2\}$ and let $\overline{I}:=\{1,\ldots,p-1\}\setminus I$.
  Let $X'':=\bigcup_{i\in I}B_G(V(C_i),r-d)$.  Apply the Hungarian Method (\cref{hungarian_method}) to $G$,$X''$, and $\{C_i:i\in\overline{I}\})$ to deduce that at least one of the following holds:
  \begin{compactenum}[(a)]\setcounter{enumi}{1}
    \item $\rho_d(G)\ge k$.  In this case there is nothing more to prove.
    \item There exists $X'\subseteq V(G)$ such that $|X'|\le f(k,p)$ and $G-(B_G(X'',d)\cup B_{G}(X',r+2d))$
    \piotr{$G-(B_G(\bigcup_{i\in I} V(C_i),r)\cup B_{G}(X',r+d))$} is a forest. For each $i\in I$, let $v_i$ be a vertex of $C_i$, define $X:=\{v_i:i\in I\}\cup X'$.  We claim that $G-B_G(X,r')$ is a forest.  Indeed, for each $i\in I$, $B_G(v_i,4r+1)\supseteq B_G(V(C_i),r)$, so $\bigcup_{i\in I}B_G(v_i)\supseteq B_G(X'',d)$, so $B_G(X,r')\supseteq B_G(X'',d)\cup B_{G}(X',r+2d)$. \qedhere
     %
     %
     %
     %
     %
     % Indeed, since $G''-B_G(X',r+2d)$ is acyclic, any cycle $C$ of $G$ that does not contain a vertex in $B_G(X',r')\supseteq B_G(X',r+2d)$ must contain a vertex in $V(G)\setminus V(G'')=B_G(\bigcup_{i\in I}V(C_i),r)\subseteq B_G(X'',7r)$.
    %
    % G''$ contains cycles $D_1,\ldots,D_k$ such that $\dist_{G'}(V(D_i),V(D_j))\ge d$ for each distinct $i,j\in\{1,\ldots,k\}$.  Observe that, for any two vertices $v,w\in V(G'')$, $\dist_{G'}(v,w)\ge d$ implies that $\dist_{G}(v,w)\ge d$.  Therefore $D_1,\ldots,D_k$ is a $d$-packing of cycles in $G$, so $\rho_d(G)\ge k$.
  \end{compactenum}
\end{proof}




Our proof makes use of an Erd\H{o}s-P\'osa type result of \citet{gyarfas.lehel:helly} which we now explain.  Let $\mathcal{T}:=(T_1,\ldots,T_p)$ be a $p$-tuple of forests.  (So $T_i$ is a forest, for each $i\in\{1,\ldots,p\}$.)  A \defin{$p$-subtree} (respectively, \defin{$p$-subgraph}) of $\mathcal{T}$ is a $p$-tuple $\mathcal{A}:=(A_1,\ldots,A_p)$ where $A_i$ is a subtree (respectively, subgraph) of $T_i$ for each $i\in\{1,\ldots,p\}$.  Two $p$-subgraphs $\mathcal{A}:=(A_1,\ldots,A_p)$ and $\mathcal{B}:=(B_1,\ldots,B_p)$ of $\mathcal{T}$ \defin{intersect} if $V(A_i)\cap V(B_i)\neq\emptyset$ for at least one $i\in\{1,\ldots,p\}$, otherwise $\mathcal{A}$ and $\mathcal{B}$ are \defin{disjoint}.

\piotr{We need more than subtrees. We need a new parameter, say $c$, and we need each $A_i$ to have at most $c$ components. In our application we will work with $c=2$.}

\pat{If we can do this, then we can easily deal with the fact that our graphs are unicyclic and not trees.  If $B$ is a ball in a unicycle $U$ and $T$ is a tree obtained by removing one edge from $U$, then $B$ is contained in two subtrees of $T$.}

\begin{lem}[\citet{gyarfas.lehel:helly}]\label{gyarfas_lehel}
  There exists a function $\ell:\N\times\N\to\N$ such that the following is true, for every $p,k\in\N$.
  Let $\mathcal{T}:=(T_1,\ldots,T_p)$ be a $p$-tuple of forests and let $\{\mathcal{A}_1,\ldots,\mathcal{A}_m\}$ be a set of $p$-subtrees of $\mathcal{T}$. Then either,
  \begin{compactenum}[(a)]
    \item $\{\mathcal{A}_1,\ldots,\mathcal{A}_m\}$ contains a set of $k$ pairwise-disjoint $p$-subtrees of $\mathcal{T}$; or
    \item there exists a $p$-subgraph $\mathcal{X}:=(X_1,\ldots,X_k)$ of $\mathcal{T}$ with $\sum_{i=1}^k|V(X_i)|\le \ell(p,k)$ such that $\mathcal{A}_i$ intersects $\mathcal{X}$ for each $i\in\{1,\ldots,m\}$.
  \end{compactenum}
\end{lem}

\begin{lem}[Hungarian Method]\label{hungarian_method}
  There exists a non-decreasing function $f:\N^2\to N$ such that the following is true: Let $d\ge 1$ and $r\ge d$ be integers.
  Let $G$ be a graph. Let $X''\subseteq V(G)$. Let $C_1,\ldots,C_{p-1}$ be a $2r$-packing of cycles in $G$ such that
  \begin{compactenum}[(i)]
    \item $G[B_G(V(C_i),r)]$ is unicyclic for each $i\in\{1,\ldots,p-1\}$;
    \item $\dist_G(V(C_i),X'')\ge r+d$ for each $i\in\{1,\ldots,p-1\}$; and
    \item $F:=G-(X''\cup \bigcup_{i=1}^{p-1} B_G(V(C_i),r-d))$ is a forest.
  \end{compactenum}
  Then $\rho_d(G)\ge k$ or there exists $X'\subseteq V(G)$ of size at most $f(k,p)$ such that $G-(B_G(X'',d)\cup B_G(X',r+2d))$ is a forest.
\end{lem}

\begin{proof}
  For each $i\in\{1,\ldots,p-1\}$, select an arbitrary vertex $v_i\in V(C_i)$.  Let $T_i:=G[B_G(V(C_i),r)]-B_G(v_i,r)$.  By (i), $T_i$ is a forest, for each $i\in\{1,\ldots,p-1\}$.
  Our strategy is use \cref{gyarfas_lehel} on the $(2p-1)$-tuple $(F,T_1,\ldots,T_{p-1},T_1,\ldots,T_{p-1})$.

  Define $F^-:=G-(X\cup \bigcup_{i=1}^p B_G(V(C_i),r-1))$.  Since $F$ is a forest and $F^-$ is a subgraph of $F$, $F^-$ is also a forest.
  An \defin{$(i,j)$-$F^-$-path} is a path $P$ in $F^-$ from a vertex $s$ with  $\dist_G(s,V(C_i))=r$ to a vertex $t$ with $\dist_G(t,V(C_j))=r$.  By (i), there is a unique shortest path $s_r,s_{r-1},\ldots,s_0$ in $G$ from $s_r:=s$ to the unique vertex $s_0\in V(C_i)$ with $\dist(s,s_0)=r$.  Similarly, there is a unique path $t_r,\ldots,t_0$ from $t_r:=t$ to the unique vertex $t_0\in V(C_j)$ with $\dist(t,t_0)=r$.  We say that $P$ is \defin{admissible} if $s_0\in V(T_i)$ and $t_0\in V(T_j)$. If $P$ is admissible then we define $P(i,j)$ to be the path in $G$ obtained by concatenating $s_0,\ldots,s_{r-1}$, $P$, and $t_{r-1},\ldots,t_0$.  We map the $(i,j)$-$F^-$-path $P$ onto the $(2p-1)$-subtree $\Phi(P):=(F_P, S_{1,P},\ldots,S_{p-1,P},T_{1,P},\ldots,T_{p-1,P})$ where
  \begin{itemize}
    \item $F_P:= F[B_F(V(P-\{s,t\}),d)]$;
    \item $S_{i,P}:=T_i[B_{T_i}(\{s_0,\ldots,s_{r-d}\},d)]$;
    \item $S_{i',P}$ is the null graph for all $i'\in\{1,\ldots,p-1\}\setminus\{i\}$.
    \item $T_{j,P}:=T_j[B_{T_j}(\{t_0,\ldots,t_{r-d}\},d)]$.
    \item $T_{j',P}$ is the null graph for all $j'\in\{1,\ldots,p-1\}\setminus\{j\}$.
  \end{itemize}
  We rely on the following important property of this mapping:
  \begin{clm}
    If $P$ is an admissible $(i,j)$-$F^-$-path, $P'$ is an admissible $(i',j')$-$F^-$-path and $\Phi(P)$ and $\Phi(P')$ are disjoint, then $\dist_G(V(P(i,j),V(P'(i',j')))\ge d$.
  \end{clm}
  \begin{clmproof}
     Suppose that $\dist_G(V(P(i,j),V(P'(i',j')))< d$ and let $a\in V(P(i,j))$ and $b\in V(P'(i,j))$ be chosen so that $\dist_G(a,b)<d$.
     \begin{compactitem}
       \item If $a,b\in V(F^-)$, then $\dist_G(a,b)=\dist_F(a,b)$ then $F_P$ and $F_{P'}$ each contain $b$, so $\Phi(P)$ and $\Phi(P')$ are not disjoint.
       \item If $a\in BV(C_i)$
     \end{compactitem}
  \end{clmproof}
  [Continue]
\end{proof}

\begin{thm}
  There exists $f:\N\to\N$ and $g:\N^2\to\N$ such that for every graph $G$, every integer $k\ge 0$ and every integer $d\ge 0$, $\rho_d(G)\ge k$ or $\tau_{g(k,d)}(G)\le f(k)$ where $g(k,d):=7d5^k+2$ and $f(k):=f(k,k)$ is the function in \cref{hungarian_method}.
\end{thm}

\begin{proof}
  \pat{Working here.}
  If $G$ is a forest, then $\tau_0(G)=0$ and there is nothing to prove. Otherwise, let $C_1$ be the shortest cycle in $G$.  We greedily construct a sequence of cycles $C_1,\ldots,C_p$ in $G$ and integers $r_1,\ldots,r_p$ with the following properties:
  \begin{compactenum}
    \item $r_{i+1}\le r_i/2$ for each $i\in\{1,\ldots,p-1\}$
    \item $\dist_G(V(C_i),V(C_1\cup\cdots\cup C_{i-1}))\ge 2r_i+1$
  \end{compactenum}Let $r:=r(\{C_1,\ldots,C_p\}):=(\min\{\dist_G(V(C_i),V(C_j)): 1\le i < j \le p\}-1)/10$. (If $p=1$, we define $r:=\infty$.  Thus $C_1,\ldots,C_p$ is a $10r$-packing of cycles in $G$.  We will always guarantee that $r\ge 10d$ and that, for each $i\in\{1,\ldots,p\}$, $G[B_G(V(C_i),r)]$ is unicyclic or $|V(C_i)|\le 6r+2$.

  Suppose that we have already constructed $C_1,\ldots,C_p$ satisfying this condition.  Let $C$ be a cycle in $G$ that maximizes $\dist_G(V(C),V(C_1\cup\cdots\cup V(C_p)))$.  We distinguish between the following cases:
  \begin{itemize}
    \item $\dist_G(V(C),V(C_1\cup\cdots\cup V(C_p))) < 9d$.  Stop and use Hungarians.  (Probably we should replace alternatives (b) and (c) in \cref{coolio} with a simple condition of the form $G-B_G(V(C_1\cup\cdots\cup C_{p-1}),r-d)$ is a forest.)
    \item $9d\le \dist_G(V(C),V(C_1\cup\cdots\cup V(C_p)))\le 10r+?$.  Add $C$ to the packing and tighten everything using \cref{short_or_unicycle_nearby}.
    \item $\dist_G(V(C),V(C_1\cup\cdots\cup V(C_p)))> 10r+?$.  Can't happen since then we would have chosen $C$ in some earlier step.
  \end{itemize}




  \pat{Old stuff:}
  Beginning with $r:=d?^k$ and repeatedly applying \cref{a_or_b} we either find cycles $C_1,\ldots,C_k$ that prove $\rho_d(G)\ge k$ or that $\tau_{7d5^k+2}(G) \le f(k)$.  \pat{This isn't quite complete.  Each time to we apply \cref{a_or_b} to find $C_p$, we need to tighten each of $C_1,\ldots,C_{p-1}$ using \cref{short_or_unicycle_nearby}. This is ok, since $r$ is decreasing exponentially, so each $C_i$ will not wander very far from its original cycle.}
\end{proof}

\section{Pat's Playground}

Going back to an old idea that I couldn't get to work before, but I think it can take care of our endgame problem.


% Let $C_1,\ldots,C_p$ be a maximal collection of cycles in $G$ that satisfy the following conditions (for $r\ge 100d$):
% \begin{compactitem}
%     \item $C_1,\ldots,C_p$ is a $2d$-packing of cycles in $G$.
%     \item $G[B_G(V(C_i),r)]$ is unicyclic.
% \end{compactitem}
% Let $C$ be shortest cycle in $G-B_G(V(C_1\cup\cdots\cup C_p),r-d)$.  Since $C_1,\ldots,C_p$ is maximal, it must be that $B_G(V(C),r)$ is not unicyclic.
% By \cref{short_or_unicycle_nearby}, $B_G(V(C),3r)$ contains a cycle $C'$ such that $|V(C')|\ge 6r+2$ or $B_G(V(C'),r)$ is unicyclic.  In the former case, we will eventually put $B_G(V(C'),3r)$ into our hitting set.  In the latter case, it must be that $\dist_G(V(C'),V(C_i))\le 2d$ for some $i\in\{1,\ldots,p\}$.  Since $G[B_G(V(C_i),r))]$ is unicyclic, $C'$ contains an edge $vw$ not in $G[B_G(V(C_i),r))]$.  In fact, it contains an edge $vw$ with $\dist_G(v,V(C_i))=r$ and $\dist_G(v,V(C_i))\in\{r,r+1\}$.


\bibliographystyle{plainurlnat}
\bibliography{cep}




\end{document}

\section{Gwen's Proof}

\begin{lem}\label{high_girth_high_degree}
  Let $G$ be a graph with $\mindeg(G)\ge k+1$ and $\girth(G)\ge 4d+3$.  Then $\rho_d(G)\ge k$.
\end{lem}

\begin{proof}
  The proof is by induction on $k$.  The case $k=0$ is trivial, so assume $k\ge 1$.  Since $\mindeg(G)\ge k+1\ge 2$, $G$ is not a forest.  Let $C$ be a cycle in $G$ of length $\girth(G)$ and let $B:=B_G(V(C),d)$.  Let $v$ be a vertex in $V(G-B)$.  If $|N_G(v)\cap B|\ge 2$, then $G[B\cup\{v\}]$ contains a cycle of length at most $|V(C)|/2+2(d+1)\le |V(C)|-\girth(G)/2+2(d+1)<|V(C)|=\girth(G)$.  Therefore, each vertex $v\in V(G-B)$ has at most one neighbour in $B$. Therefore $G-B$ has $\mindeg(G)-1\ge (k-1)+1$ and $\girth(G-B)\ge \girth(G)\ge 4d+3$.  By induction $\rho_d(G-B)\ge k-1$, so $G-B$ has a packing of cycles $C_1,\ldots,C_{k-1}$ whose pairwise distances are at least $d$. OOPS. Stuck here, since $\dist_G(V(C_i),V(C_j)$ is, in general, less than $\dist_{G-B}(V(C_i),V(C_j))$, so $C_1,\ldots,C_{k-1}$ is not necessarily a $d$-packing of cycles in $G$.
\end{proof}




\begin{lem}
  Let $G$ be a graph with $\mindeg(G)\ge 3$ and $\girth(G)\ge 2(4d+3)\log(k+1)$.  Then $\rho_d(G)\ge k$.
\end{lem}

\begin{proof}
  Greedily pack balls of radius $\log(k+1)$ into $G$ to get a set of centers $Z$ such that $\dist_G(v,Z)<2\log(k+1)$ for each $v\in V(G)$.  For each $v\in V(G-Z)$, let $p_v$ be a neighbour of $v$ in $G$ such that $\dist_G(v,Z)=1+\dist_G(p_v,Z)$. Then the graph $F$ with vertex set $V(F):=V(G)$ and edge set $E(F):=\{vp_v:v\in V(G-Z)\}$ is a forest that contains one tree $T_x$ with $x\in V(T_x)$ for each vertex $x\in Z$.  We treat each $T_x$ as a rooted tree whose root is $x$.  For each $x\in Z$, let $B_x:=V(T_x)$.  Observe that, for each $x\in Z$, $G[B_x]=T_x$ since, otherwise, $G[B_x]$ contains a cycle of length at most $4\log(k+1)<\girth(G)$. Similarly, if $G[B_x\cup B_x]\neq T_i\cup T_j$ for some distinct $i,j\{1,\ldots,m\}$, then $G[B_i\cup B_j]$ contains a cycle of length at most $8\log(k+1)<\girth(G)$. Therefore, for distinct $x,y\in Z$, $G[B_x\cup B_y]$ is a forest. In particular, $G$ contains at most one edge $vw$ with $v\in B_x$ and $w\in B_y$.  Since $\mindeg(G)\ge 3$, each $T_x$ has at least $3\cdot2^{\floor{\log(k+1)}-1}> (k+1)/2$ vertices of depth $\floor{\log(k+1)}$, so $T_x$ has at least $(k+1)/2$ leaves.  For each leaf $v$ of $T_x$, $N_G(v)$ contains at least two vertices not in $T_x$. Therefore, for each $x\in Z$, there are at least $k+1$ nodes $y\in Z\setminus\{x\}$ such that $G$ contains an edge $vw$ with $v\in B_x$ and $w\in B_y$.

  Let $G'$ be the induced minor of $G$ obtained by contracting $T_x$, for each $x\in Z$.  Then $\mindeg(G')\ge k+1$ and $\girth(G')\ge \girth(G)/(2\log(k+1))\ge 4d+3$.  By \cref{high_girth_high_degree}, $\rho_d(G')\ge k+1$. Since $G'$ is an induced minor of $G$, $\rho_d(G)\ge \rho_d(G')$.
\end{proof}


Now the proof finishes by eliminating degree-$1$ vertices and replacing long paths of degree-$2$ vertices with paths of length at most $2d$.

\section{Meat}

\begin{lem}\label{hitting_is_additive}
  Let $G$ be a graph and let $X\subseteq V(G)$.  Then, for any integer $r\ge 0$, $\tau_r(G) \le |X| + \tau_r(G-B_G(X,r))$.
\end{lem}

\begin{proof}
  Let $G':=G-B_G(X,r)$.
  Let $Y$ be a radius-$r$ hitting set of cycles in $G'$ with $|Y|=\tau_r(G')$.  Then $G-(B_G(X\cup Y,r))\subseteq (G-B_G(X,r))-B_{G'}(Y,r)$ is a forest, so $\tau_r(G)\le |X\cup Y|\le |X|+\tau_r(G')$.
\end{proof}

\begin{lem}\label{fattening}
  Let $r\ge 1$ be an integer, let $G$ be a graph, let $C_1,\ldots,C_p$ be cycles in $G$ such that $\radius_G(V(C_i))\le r$ for each $i\in\{1,\ldots,p\}$ and $\dist_G(V(C_i),V(C_j)\ge d$ for each distinct $i,j\in\{1,\ldots,p\}$, let $X:=\bigcup_{i=1}^p V(C_i)$, and let $G':=G-B_G(X,d)$.  Then $\rho_d(G)\ge p + \rho_d(G')$ and
  $\tau_{d+r}(G) \le p + \tau_{r+d}(G')$.
\end{lem}

\begin{proof}
  % Let $G':=G-B_G(X,d)$, so we need to show that $\rho_d(G)\ge p+\rho_d(G')$ and $\tau_{r+d}(G)\le p + \tau_{r+d}(G')$.
  First we show that $\rho_{d}(G)\ge p+\rho_d(G')$.
  Let $A$ be a distance-$d$ packing of cycles in $G'$ of size $\rho_d(G')$.  Since $\dist_G(x,y)\ge d$ for each $x\in X$ and $y\in V(G')$, $\dist_G(V(C_i),V(C))\ge d$ for each $i\in\{1,\ldots,p\}$ and each $C\in A$. Therefore, $\{C_1,\ldots,C_p\}\cup A$ is a distance-$d$ packing of cycles in $G$, so $\rho_d(G)\ge p + |A| = p + \rho_d(G')$.

  To see why $\tau_{r+d}(G) \le p + \tau_{r+d}(G')$ holds,  let $X':=\{v_1,\ldots,v_p\}$ be vertices of $G$ such that $V(C_i)\subseteq B_G(v_i,r)$ for each $i\in\{1,\ldots,p\}$.  Observe that $B_G(v_i,r+d)\supseteq B_G(V(C_i),d)$, since $\dist_G(x,V(C_i))\le \dist(x,v_i)+r$ for each $x\in V(G)$.   Therefore $B_G(X',r+d)\supseteq B_G(X,d)$ so $G'':=G-B_G(X',r+d)\subseteq G'$.  Let $Y$ be a radius-$(r+d)$ hitting set for cycles in $G'$ of size $\tau_{r+d}(G')$.  We now argue that $G-B_G(X'\cup Y,r+d)$ is a forest. To see this, let $C$ be a cycle in $G$.  If $C$ is not contained in $G''$ then $C$ contains at least one vertex in $B_G(X',r+d)$, so $C$ is not a cycle in $G-B_G(X'\cup Y,r+d)$.  If $C$ is contained in $G''$ then $C$ is also contained in $G'\supseteq G''$.  Therefore $C$ contains at least one vertex in $B_{G'}(Y,r+d)\subseteq B_G(Y,r+d)$, so $C$ is not a cycle in $G-B_G(X'\cup Y,r+d)$. Therefore  $G-B_G(X'\cup Y,r+d)$ is a forest, so $\tau_{r+d}(G)\le |X'\cup Y| = p+\tau_{r+d}(G')$.
\end{proof}

\begin{lem}[Simonovitz] \label{Simonovitz_original}
  There exists a constant $c>0$ such that for every integer $k\ge 2$, every cubic multigraph $G$ with at least $ck\log k$ vertices contains $k$ pairwise vertex-disjoint cycles.
\end{lem}

A small modification of the original  proof of \cref{Simonovitz_original} yields the following strengthening:

\begin{lem}\label{Simonovitz_distance}
  There exists a constant $c>0$ such that for every integer $k\ge 2$, every cubic multigraph $G$ with at least $ck\log k$ vertices contains $k$ cycles $C_1,\ldots,C_k$ such that $\dist_G(V(C_i),V(C_j))\ge 2$ for each $i,j\in\{1,\ldots,k\}$.
\end{lem}

\begin{lem}
  There exists a constant $c>0$ such that the following is true.
  Let $G$ be a graph, let $C$ be a cycle in $G$ and, for each $r\in\N$, let $G_r:=G[B_G(V(C),r)]$.  Then, for any integers $d\ge 0$ and $k\ge 1$, either
  \begin{compactenum}
    \item $G_{2r}$ contains $k$ cycles $C_1,\ldots,C_k$ such that $\dist_G(V(C_i),V(C_j))\ge d$ for each distinct $i,j\in\{1,\ldots,m\}$; or
    \item there exists $X\subseteq V(C)$ of size at most $ck\log k$ such that $G_{2d}-B_G(X,5d)$ is a forest.
  \end{compactenum}
\end{lem}

\begin{proof}
  Let $U$ be a unicyclic subgraph of $G_{2d}$ that spans $V(G_{2d})$, contains every edge of $C$ and for each vertex in $v\in V(G_{2d})\setminus V(C)$ contains exactly one edge $vw$ such that $\dist_G(w,V(C))=\dist_G(v,V(C))-1$.  (Informally, $U$ is obtained from a BFS forest rooted at the vertices of $C$ by adding the edges of $C$.)

  Let $x_0$ be any vertex of $C$ and let $T$ be the tree obtained from $U$ by removing one of the edges of $C$ incident to $x_0$.  For any edge $vw\in E(G_{2d})\setminus E(U)$, consider the subgraph $Q_{vw}$ of $G_{2r}$ formed by taking the union of the edge $vw$, $\pth_T(v,V(C))$, and $\pth_T(w,V(C))$. Then $Q_{vw}$ is either a path with both endpoints in $V(C)$ and no other vertices in $V(C)$ or $Q_{vw}$ is a lollipop whose (possibly $0$-length) handle begin in $V(C)$.\todo{Define lollipop and handle}
  %
  %
  % there is exactly one path $P_{vw}$ in $T-v_0$ with endpoints $v$ and $w$ and $E(P_{vw})\cup\{vw\}$ is the edge set of a cycle $C_{vw}$ in $G_{2d}$. Let $A_{vw}:=E(C_{vw})\setminus E(C)$ and treat $A_{vw}$ as a graph.  Then $A_{vw}$ is a non-empty connected subgraph of $C_{vw}$ having at most $2d$ edges.  Let $B_{vw}:=E(C_{vw})\cap E(C)$.  Treating $B_{vw}$ as a graph, we see that $B_{vw}$ is a connected (possibly null) subgraph of $C$.

  We construct a set $X\subseteq V(G_{2d})$ and a subgraph $Q$ of $G_{2d}$. We begin with $X:=\{x_0\}$ and $Q:=C$.  As long as $G_{2d}-B_G(X,5d)$ contains an edge $vw\not\in E(T)$ such that $V(C_{vw})$ has no vertex in $B_G(X,5d)$, we grow $X$ by adding the at most two vertices $V(Q_{vw})\cap V(C)$ to $X$.  We grow $Q$ by adding $Q_{vw}$ to $Q$.

  Let $t$ be the number of iterations performed by this procedure before stopping.  For each $i\in\{1,\ldots,t\}$, let $v_iw_i$ be the edge of $E(G_{2r})\setminus E(T)$ chosen in iteration $i$, let $X_i$ be the set of one or two vertices of $C$ added to $X$ in iteration $i$ and let $Q_i$ be the subgraph added to $Q$ in iteration $i$.  The stopping condition implies that the edges of $G_{2r}-B_G(X,5d)$ are a subset of the edges of $T$, so $G_{2d}-B_G(X,5d)$ is a forest.  All that remains is to show that, if $t>ck\log k$ then $G_{2d}$ contains $k$ cycles $C_1,\ldots,C_k$ such that $\dist_G(V(C_i),V(C_j))\ge d$ for each distinct $i,j\in\{1,\ldots,k\}$.

  Observe that, for distinct $i,j\in\{1,\ldots,t\}$, $\dist_G(X_i,X_j)\ge 5d$.  Since $V(Q_i)\subseteq B_G(X_i,2d)$ and $V(Q_j)\subseteq B_G(X_j,2d)$, this implies that $\dist_G(V(Q_i),V(Q_j))\ge d$.

  We say that an iteration $i$ is \defin{short} if $Q_i$ is a lollipop or if $Q_i$ is a path with endpoints $x_i$ and $y_i$ in $V(C)$ and $G-(V(Q_i)\setminus\{x_i,y_i\})$ contains a path $P_i$ with endpoints $x_i$ and $y_i$ of length at most $4d$.  In the former case, we define $C_i$ to be the unique cycle in $Q_i$. I the latter case we define $C_i:=P_i\cup Q_i$.  In either case, $V(C_i)\subseteq B_G(X_i,2d)$.  Therefore, iterations $i$ and $j$ are both short, then $\dist_G(V(C_i),V(C_j))\ge d$.  Therefore, if the number of short iterations is at least $k$, then the cycles determined by the set of short iterations satisfy the conditions of the lemma.  We conclude that there are at most $k$ short iterations, so at least $ck\log k-k$ are not short.

  Let $I\subseteq \{1,\ldots,k\}$ index only the iterations that are not short and consider the graph $Q_I:=C\cup\bigcup_{i\in I} Q_i$.  Then $Q_I$ is a graph in which each vertex has degree $3$ or $2$.  Suppress all degree-$2$ vertices in $Q_I$ to obtain a cubic multigraph $Q_I'$.  For a vertex $v$ in $Q_I'$ with incident edges $vv_1$, $vv_2$, and $vv_3$ there is at most one $i\in\{1,2,3\}$ such that $\dist_G(v,v_i)<d$.  CRAP CRAP CRAP.



  Now apply Simonovitz on $Q':=C\cup \bigcup_{i\in\overline{I}} Q_i$ to obtain $\Omega(k/\log k)$ disjoint cycles.  Finally, observe that for any distinct degree-$3$ vertices $x,y\in V(Q')$, $\dist_G(x,y)\ge d$, so the $\rho_d(G_{2d})\ge \Omega(k/\log k)$.
\end{proof}



\begin{lem}
  Let $G$ be a graph and let $P_0,\ldots,P_m$ be subsets of $V(G)$ such that
  $\bigcup_{i=1}^m B_G(P_i,d)=V(G)$ and
  $G[B_G(P_i,2d)]$ is a forest, for each $i\in\{1,\ldots,m\}$.  Then
\end{lem}







\end{document}




% \gwen{Another option for the title: Planar graphs as blowups of fans}
%
% \pat{Planar graphs in blowups of fans(?)}
%
% \david{I think `Planar graphs as blowups of fans' reads better than `Planar graphs in blowups of fans', whereas the latter is more accurate. I would weakly lean towards `Planar graphs in blowups of fans'}
%
% \pat{Near rootish blowups of fans contain all planar graphs}
% \david{what does rootish mean, or is it another joke?} \pat{No, not a joke.  Just a way to avoid a square root symbol in a title.} \david{when I read this, I had no idea ``rootish'' refered to square root of $n$.}


\begin{abstract}
\end{abstract}

\section{Introduction}

For a graph $G$ and a vertex $v\in V(G)$, let $\mathdefin{\deg_G(v)}:=|\{w\in V(G):vw\in E(G)\}|$ be the \defin{degree} of $v$ in $G$.  For each non-negative integer $d$, let $\mathdefin{V_d(G)}:=\{v\in V(G):\deg_G(v)=d\}$.

Let $G$ be a graph and let $F$ be a subgraph of $G$ such that $\deg_F(v)\in\{2,3\}$ for each $v\in V(F)$.  We say that a path $P=p_0,\ldots,p_\ell$ in $G$ is an \defin{extension} of $(G,F)$ if
\begin{compactenum}[(a)]
  \item $\deg_F(p_0)=\deg_F(u_\ell)=2$;
  \item $p_1,\ldots,p_m\in V(G)\setminus V(F)$; and
  \item $G[V(P)]=P$ (i.e., $P$ is an induced path in $G$).
\end{compactenum}
In this case, we call $P$ a \defin{$u_0u_m$-extension} of $(G,F)$.
For a positive integer $k$, we say that an extension $P$ of $(G,F)$ is \defin{$k$-bad} if $F\cup P$ contains a cycle $C$ such that
\begin{compactenum}[(b-i)]
  \item $P\subseteq C$;
  \item $|V(C)\cap V_3(F)|\le \log_2 k$; and
  \item $G[V(C)]$ is chordal.
\end{compactenum}
We say that $C$ \defin{witnesses} the fact that $P$ is $k$-bad.
If $P$ is not $k$-bad, then $P$ is \defin{$k$-good}.


A graph is \defin{outerplanar} if it has a planar drawing in which all vertices appear on a single face.  If this face is unique, we call it the \defin{outer face}.

\begin{obs}\label{hamiltonian}
  If $H$ is Hamiltonian chordal graph with at least $3$ vertices then, for any Hamiltonian cycle $C$ of $H$, $H$ contains an edge-maximal outerplanar graph $H'$ whose outer face is $C$.
\end{obs}

A \defin{chord} of a cycle $C$ in a graph $G$ is an edge $vw\in E(G)$ such that $v,w\in V(C)$ but $vw\not\in E(C)$.  $C$ is \defin{chord-free} if has no chord.  A \defin{hole} in $G$ is a chord-free cycle with at least four vertices. $G$ is \defin{chordal} if it has no holes.

Consider the following construction of graphs $F_0,\ldots,F_r\subseteq G$, where $G$ is a non-chordal graph:  Let $F_0$ be a minimum-size hole in $G$. For $i\ge 1$, if all extensions of $(G,F_{i-1})$ are $k$-bad, then $r:=i-1$ and we are done.  Otherwise, let $P_i$ be a good extension of $(G,F_{i-1})$ of minimum size and set $F_i:=F_{i-1}\cup P_i$.

Note that in the following lemma, there can be vertices $v,w\in V_2(F)$, that have no $vw$-extension of $(G,F_r)$.  This happens when $v$ and $w$ are in different components of $G-(V(F)\setminus\{v,w\})$.

\begin{lem}\label{coolio}
  For each distinct $v,w\in V_2(F_{r})$, and each $vw$-extension $P$ of $F_r$, there exists a cycle $C$ in $F_r\cup P$ that witnesses the fact that $P$ is bad and such that $G[V(C)]$ contains an edge-maximal outerplanar graph $H$ whose outer face is $C$ and such that $V_2(H)=\{v,w\}$.
  \end{compactenum}
\end{lem}


\begin{proof}
  Let $P:=p_0,\ldots,p_\ell$ be a $vw$-extension of $(G,F_r)$.  Since the construction of $F_r$ stopped at iteration $r+1$, $P$ is a bad extension of $(G,F_r)$.  Let $C$ be the minimum-length cycle that witnesses the fact that $P$ is $k$-bad.  By \cref{hamiltonian} $G[V(C)]$ contains an edge-maximal outerplanar graph $H$ whose outer face is $C$.  Since $P$ is an induced path in $G$ and $H$ is edge-maximal outerplanar, $\deg_{H}({p_i})\neq 2$ for each $i\in\{1,\ldots,\ell-1\}$.  Let $Q:=q_0,\ldots,q_m=C-\{p_1,\ldots,p_{\ell-1}\}$.  Since $C$ has minimum length, $Q$ is an induced path in $G[V(F_r)]$.  Again, this implies that $\deg_{H}(q_i)}\neq 2$ for each $i\in\{1,\ldots,m-1\}$.  Therefore $V_2(H)=\{p_0,q_0,p_\ell,q_m\}=\{v,w\}$.
\end{proof}

\begin{lem}
  Let $P:=p_0,\lots,p_\ell$ be an induced path in $G$ that starts at $p_0\in V_2(F_r)$ in the interior of some extension $P_i$, ends at some vertex $p_\ell\in V_2(F_r)$ in the interior of some extension $P_j$ for some $i\neq j$, and has no interior vertices in $V(F_r)$.  Then, for some $x\in\{1,\ldots,\ell-1\}$,  $N_G(x)$ contains a vertex in $V(P_i)\cap V_3(F_r)$.
\end{lem}

\begin{proof}
  Consider the cycle $C$ and the edge-maximal outerplanar graph $H$ guaranteed by \cref{coolio}.  Then $Q:=C-\{p_1,\ldots,p_{\ell-1}\}$ is a path in $F_r$ with endpoints $p_0$ and $p_\ell$.  Therefore $Q$ contains a degree-$3$ vertex $w$ of $P_i$.  Since $p_0,p_\ell\in V_2(F_r)$,  $w\not\in \{p_0,p_{\ell}\}$.  Therefore $\deg_H(w)\ge 3$,  which implies that $w$ is adjacent, in $G$, to some vertex in the interior of $P$.
\end{proof}


\section*{Acknowledgement}

This research was initiated and much of it was done at the \emph{Third Workshop on Graphs and Probability} held in Lac-Sainte-Marie, Québec, October 14--18, 2024.
% \david{I would replace ``somehow manages to be'' by ``is''.}

% ?Let $\phi'(x):=\phi(x)/\sqrt{L}$ for each $x\in V(H\boxtimes P)$.

\bibliographystyle{plainurlnat}
\bibliography{fan-partition}

\end{document}
